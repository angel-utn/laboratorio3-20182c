 -- LISTAR LOS DATOS DE LA ACTIVIDAD MÁS COSTOSA. 
 --SI HAY MÁS DE UNA, LISTARLAS TODAS.
SELECT * FROM ACTIVIDADES WHERE COSTO = (SELECT MAX(COSTO) FROM ACTIVIDADES)

 -- LISTAR LOS DATOS DE LAS ACTIVIDADES QUE SEAN MÁS BARATAS QUE EL 
 --COSTO PROMEDIO DE ACTIVIDADES.
SELECT * FROM ACTIVIDADES WHERE COSTO < (SELECT AVG(COSTO) FROM ACTIVIDADES)

 -- LISTAR LOS DATOS DE LAS ACTIVIDADES QUE SEAN MÁS 
 --CARAS QUE CUALQUIER ACTIVIDAD EN EQUIPO .
 SELECT * FROM ACTIVIDADES WHERE COSTO >ALL (SELECT COSTO FROM ACTIVIDADES WHERE TIPO = 'E')

SELECT * FROM ACTIVIDADES WHERE COSTO > (SELECT MAX(COSTO) FROM ACTIVIDADES WHERE TIPO = 'E')

 -- LISTAR LOS DATOS DE LAS ACTIVIDADES QUE SEAN MÁS CARAS 
 -- QUE ALGUNA ACTIVIDAD DE EQUIPO.
SELECT * FROM ACTIVIDADES WHERE COSTO >ANY (SELECT COSTO FROM ACTIVIDADES WHERE TIPO = 'E')

SELECT * FROM ACTIVIDADES WHERE COSTO > (SELECT MIN(COSTO) FROM ACTIVIDADES WHERE TIPO = 'E')

 -- LISTAR LOS DATOS DE TODAS LAS SEDES CUYAS CIUDADES 
 -- PERTENEZCAN A LA PROVINCIA DE BUENOS AIRES.
SELECT * FROM SEDES WHERE CP IN (SELECT CP FROM LOCALIDADES WHERE IDPROVINCIA = 1)

 -- LISTAR LOS DATOS DE TODOS LOS SOCIOS QUE 
 -- REALICEN ACTIVIDADES DE EQUIPO.
 SELECT * FROM SOCIOS WHERE LEGAJO IN (
	 SELECT DISTINCT LEGAJO FROM ACTIVIDADES_X_SOCIO AS AXS INNER JOIN
	 ACTIVIDADES AS A ON A.IDACTIVIDAD = AXS.IDACTIVIDAD
	 WHERE A.TIPO = 'E'
 )

 -- LISTAR LOS DATOS DE TODOS LOS SOCIOS QUE 
 -- NO REALICEN NINGUNA ACTIVIDAD.
 SELECT * FROM SOCIOS WHERE LEGAJO NOT IN (
	SELECT DISTINCT LEGAJO FROM ACTIVIDADES_X_SOCIO
)

 -- LISTAR LOS DATOS DE TODOS LOS SOCIOS Y 
 -- LA CANTIDAD DE ACTIVIDADES DE CADA TIPO REALIZADAS.
SELECT S.*, 
(SELECT COUNT(*) FROM ACTIVIDADES_X_SOCIO AS AXS 
INNER JOIN ACTIVIDADES AS A ON A.IDACTIVIDAD = AXS.IDACTIVIDAD
WHERE A.TIPO = 'E' AND AXS.LEGAJO = S.LEGAJO) AS CANTE, 
(SELECT COUNT(*) FROM ACTIVIDADES_X_SOCIO AS AXS 
INNER JOIN ACTIVIDADES AS A ON A.IDACTIVIDAD = AXS.IDACTIVIDAD
WHERE A.TIPO = 'I' AND AXS.LEGAJO = S.LEGAJO) AS CANTI
FROM SOCIOS AS S

 -- LISTAR LOS DATOS DE TODOS LOS SOCIOS 
 -- Y LA CANTIDAD DE PAGOS REALIZADOS.
 SELECT S.*, 
 (SELECT COUNT(*) FROM PAGOS AS P WHERE P.LEGAJO = S.LEGAJO) AS CANTPAGOS
 FROM SOCIOS AS S

 -- LISTAR LOS DATOS DE TODOS LOS SOCIOS QUE HAYAN 
 -- REALIZADO UN SOLO PAGO.
SELECT S.*, 
 (SELECT COUNT(*) FROM PAGOS AS P WHERE P.LEGAJO = S.LEGAJO) AS CANTPAGOS
 FROM SOCIOS AS S
WHERE 
(SELECT COUNT(*) FROM PAGOS AS P WHERE P.LEGAJO = S.LEGAJO) = 1

 -- LISTAR LOS DATOS DE TODOS LOS SOCIOS 
 --QUE HAYAN REALIZADO ACTIVIDADES DE EQUIPO 
 --PERO NINGUNA ACTIVIDAD INDIVIDUAL.
SELECT S.*, 
(SELECT COUNT(*) FROM ACTIVIDADES_X_SOCIO AS AXS 
INNER JOIN ACTIVIDADES AS A ON A.IDACTIVIDAD = AXS.IDACTIVIDAD
WHERE A.TIPO = 'E' AND AXS.LEGAJO = S.LEGAJO) AS CANTE, 
(SELECT COUNT(*) FROM ACTIVIDADES_X_SOCIO AS AXS 
INNER JOIN ACTIVIDADES AS A ON A.IDACTIVIDAD = AXS.IDACTIVIDAD
WHERE A.TIPO = 'I' AND AXS.LEGAJO = S.LEGAJO) AS CANTI
FROM SOCIOS AS S
WHERE (SELECT COUNT(*) FROM ACTIVIDADES_X_SOCIO AS AXS 
INNER JOIN ACTIVIDADES AS A ON A.IDACTIVIDAD = AXS.IDACTIVIDAD
WHERE A.TIPO = 'E' AND AXS.LEGAJO = S.LEGAJO) > 0
AND (SELECT COUNT(*) FROM ACTIVIDADES_X_SOCIO AS AXS 
INNER JOIN ACTIVIDADES AS A ON A.IDACTIVIDAD = AXS.IDACTIVIDAD
WHERE A.TIPO = 'I' AND AXS.LEGAJO = S.LEGAJO) = 0

SELECT * FROM
	(SELECT S.*, 
		(SELECT COUNT(*) FROM ACTIVIDADES_X_SOCIO AS AXS 
		INNER JOIN ACTIVIDADES AS A ON A.IDACTIVIDAD = AXS.IDACTIVIDAD
		WHERE A.TIPO = 'E' AND AXS.LEGAJO = S.LEGAJO) AS CANTE, 
		(SELECT COUNT(*) FROM ACTIVIDADES_X_SOCIO AS AXS 
		INNER JOIN ACTIVIDADES AS A ON A.IDACTIVIDAD = AXS.IDACTIVIDAD
		WHERE A.TIPO = 'I' AND AXS.LEGAJO = S.LEGAJO) AS CANTI
	FROM SOCIOS AS S) AS DATOS
WHERE DATOS.CANTE >0 AND DATOS.CANTI = 0



 -- LISTAR LOS DATOS DE TODOS LOS SOCIOS QUE HAYAN 
 --REALIZADO MÁS ACTIVIDADES DE EQUIPO QUE INDIVIDUALES 
 --PERO AL MENOS UNA ACTIVIDAD INDIVIDUAL.
 SELECT * FROM
	(SELECT S.*, 
		(SELECT COUNT(*) FROM ACTIVIDADES_X_SOCIO AS AXS 
		INNER JOIN ACTIVIDADES AS A ON A.IDACTIVIDAD = AXS.IDACTIVIDAD
		WHERE A.TIPO = 'E' AND AXS.LEGAJO = S.LEGAJO) AS CANTE, 
		(SELECT COUNT(*) FROM ACTIVIDADES_X_SOCIO AS AXS 
		INNER JOIN ACTIVIDADES AS A ON A.IDACTIVIDAD = AXS.IDACTIVIDAD
		WHERE A.TIPO = 'I' AND AXS.LEGAJO = S.LEGAJO) AS CANTI
	FROM SOCIOS AS S) AS DATOS
WHERE DATOS.CANTE > DATOS.CANTI AND DATOS.CANTI > 0

 

